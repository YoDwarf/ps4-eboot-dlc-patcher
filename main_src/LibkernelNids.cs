namespace ps4_eboot_dlc_patcher;
internal class LibkernelNids
{
    // the libkernel module contains multiple libraries, but we can only use the NIDs from the main libkernel library
    // TODO: Since the module loader now parses the library ids correctly, we could filter by that and not need this
    private static readonly List<string> libkernelSymbols = [
        "__stack_chk_guard",
        "__stack_chk_fail",
        "sceKernelAddCpumodeEvent",
        "sceKernelAddFileEvent",
        "sceKernelAddGpuExceptionEvent",
        "sceKernelAddHRTimerEvent",
        "sceKernelAddReadEvent",
        "sceKernelAddTimerEvent",
        "sceKernelAddUserEvent",
        "sceKernelAddUserEventEdge",
        "sceKernelAddWriteEvent",
        "sceKernelAioCancelRequest",
        "sceKernelAioCancelRequests",
        "sceKernelAioDeleteRequest",
        "sceKernelAioDeleteRequests",
        "sceKernelAioInitializeImpl",
        "sceKernelAioInitializeParam",
        "sceKernelAioPollRequest",
        "sceKernelAioPollRequests",
        "sceKernelAioSetParam",
        "sceKernelAioSubmitReadCommands",
        "sceKernelAioSubmitReadCommandsMultiple",
        "sceKernelAioSubmitWriteCommands",
        "sceKernelAioSubmitWriteCommandsMultiple",
        "sceKernelAioWaitRequest",
        "sceKernelAioWaitRequests",
        "sceKernelAllocateDirectMemory",
        "sceKernelAllocateDirectMemoryForMiniApp",
        "sceKernelAllocateMainDirectMemory",
        "sceKernelAllocateTraceDirectMemory",
        "sceKernelAvailableDirectMemorySize",
        "sceKernelAvailableFlexibleMemorySize",
        "sceKernelBacktraceSelf",
        "sceKernelBatchMap",
        "sceKernelBatchMap2",
        "sceKernelCancelEventFlag",
        "sceKernelCancelSema",
        "sceKernelCheckedReleaseDirectMemory",
        "sceKernelCheckReachability",
        "sceKernelChmod",
        "sceKernelClearBootReqNotifyCount",
        "sceKernelClearEventFlag",
        "sceKernelClearGameDirectMemory",
        "sceKernelClockGetres",
        "sceKernelClockGettime",
        "sceKernelClose",
        "sceKernelCloseEport",
        "sceKernelCloseEventFlag",
        "sceKernelCloseSema",
        "sceKernelConfiguredFlexibleMemorySize",
        "sceKernelConvertLocaltimeToUtc",
        "sceKernelConvertUtcToLocaltime",
        "sceKernelCreateEport",
        "sceKernelCreateEqueue",
        "sceKernelCreateEventFlag",
        "sceKernelCreateSema",
        "sceKernelDebugAcquireAndUpdateDebugRegister",
        "sceKernelDebugGetAppStatus",
        "sceKernelDebugGetPauseCount",
        "sceKernelDebugGpuPaDebugIsInProgress",
        "sceKernelDebugOutText",
        "sceKernelDebugRaiseException",
        "sceKernelDebugRaiseExceptionOnReleaseMode",
        "sceKernelDebugRaiseExceptionWithContext",
        "sceKernelDebugRaiseExceptionWithInfo",
        "sceKernelDebugReleaseDebugContext",
        "sceKernelDeleteCpumodeEvent",
        "sceKernelDeleteEport",
        "sceKernelDeleteEqueue",
        "sceKernelDeleteEventFlag",
        "sceKernelDeleteFileEvent",
        "sceKernelDeleteGpuExceptionEvent",
        "sceKernelDeleteHRTimerEvent",
        "sceKernelDeleteReadEvent",
        "sceKernelDeleteSema",
        "sceKernelDeleteTimerEvent",
        "sceKernelDeleteUserEvent",
        "sceKernelDeleteWriteEvent",
        "sceKernelDirectMemoryQuery",
        "sceKernelDirectMemoryQueryForId",
        "sceKernelDlsym",
        "sceKernelEnableDmemAliasing",
        "sceKernelEnableDmemAliasing2",
        "sceKernelEnablePthreadObjectCheck",
        "sceKernelError",
        "sceKernelEventLogInit",
        "sceKernelEventLogPread",
        "sceKernelEventLogRead",
        "sceKernelEventLogWrite",
        "sceKernelFchmod",
        "sceKernelFcntl",
        "sceKernelFdatasync",
        "sceKernelFlock",
        "sceKernelFstat",
        "sceKernelFsync",
        "sceKernelFtruncate",
        "sceKernelFutimes",
        "sceKernelGetAllowedSdkVersionOnSystem",
        "sceKernelGetAppInfo",
        "sceKernelGetAslrStatus",
        "sceKernelGetBackupRestoreMode",
        "sceKernelGetBackupRestoreModeOfNextBoot",
        "sceKernelGetBasicProductShape",
        "sceKernelGetBetaUpdateTestForRcmgr",
        "sceKernelGetBioUsageAll",
        "sceKernelGetBootReqNotifyCount",
        "sceKernelGetCallRecord",
        "sceKernelGetCompiledSdkVersion",
        "sceKernelGetCompiledSdkVersionByPath",
        "sceKernelGetCompiledSdkVersionByPid",
        "sceKernelGetCpuFrequency",
        "sceKernelGetCpumode",
        "sceKernelGetCpumodeGame",
        "sceKernelGetCpuTemperature",
        "sceKernelGetCpuUsage",
        "sceKernelGetCpuUsageAll",
        "sceKernelGetCpuUsageProc",
        "sceKernelGetCpuUsageProc2",
        "sceKernelGetCpuUsageThread",
        "sceKernelGetCurrentCpu",
        "sceKernelGetDataTransferMode",
        "sceKernelGetDebugMenuMiniModeForRcmgr",
        "sceKernelGetDebugMenuModeForPsmForRcmgr",
        "sceKernelGetDebugMenuModeForRcmgr",
        "sceKernelGetdents",
        "sceKernelGetDirectMemorySize",
        "sceKernelGetDirectMemoryType",
        "sceKernelGetdirentries",
        "sceKernelGetEventData",
        "sceKernelGetEventError",
        "sceKernelGetEventFflags",
        "sceKernelGetEventFilter",
        "sceKernelGetEventId",
        "sceKernelGetEventUserData",
        "sceKernelGetExecutableModuleHandle",
        "sceKernelGetExtLibcHandle",
        "sceKernelGetFakeFinalizeMenuForRcmgr",
        "sceKernelGetFlagedUpdaterForRcmgr",
        "sceKernelGetForceUpdateModeForRcmgr",
        "sceKernelGetFsSandboxRandomWord",
        "sceKernelGetGPI",
        "sceKernelGetGPO",
        "sceKernelGetHwFeatureInfoForDecid",
        "sceKernelGetIdPs",
        "sceKernelGetIdTableCurrentCount",
        "sceKernelGetIpcPath",
        "sceKernelGetLibkernelTextLocation",
        "sceKernelGetMainSocId",
        "sceKernelGetModuleInfo",
        "sceKernelGetModuleInfoForUnwind",
        "sceKernelGetModuleInfoFromAddr",
        "sceKernelGetModuleInfoInternal",
        "sceKernelGetModuleList",
        "sceKernelGetModuleListInternal",
        "sceKernelGetOpenPsIdForSystem",
        "sceKernelGetPageTableStats",
        "sceKernelGetPagingStatsOfAllObjects",
        "sceKernelGetPagingStatsOfAllThreads",
        "sceKernelGetPhysPageSize",
        "sceKernelGetProcessName",
        "sceKernelGetProcessTime",
        "sceKernelGetProcessTimeCounter",
        "sceKernelGetProcessTimeCounterFrequency",
        "sceKernelGetProcessType",
        "sceKernelGetProcParam",
        "sceKernelGetProductCode",
        "sceKernelGetProductStr",
        "sceKernelGetPrtAperture",
        "sceKernelGetPsmIntdevModeForRcmgr",
        "sceKernelGetPsnAccessTraceLogForRcmgr",
        "sceKernelGetQafExpirationTimeNotafterForRcmgr",
        "sceKernelGetQafExpirationTimeNotbeforeForRcmgr",
        "sceKernelGetQafGenerationForRcmgr",
        "sceKernelGetQafNameForRcmgr",
        "sceKernelGetRenderingMode",
        "sceKernelGetResidentCount",
        "sceKernelGetResidentFmemCount",
        "sceKernelGetSafemode",
        "sceKernelGetSanitizerMallocReplace",
        "sceKernelGetSanitizerMallocReplaceExternal",
        "sceKernelGetSanitizerNewReplace",
        "sceKernelGetSanitizerNewReplaceExternal",
        "sceKernelGetSocPowerConsumption",
        "sceKernelGetSocSensorTemperature",
        "sceKernelGetSpecialIForRcmgr",
        "sceKernelGetSubsysId",
        "sceKernelGetSystemExVersion",
        "sceKernelGetSystemLevelDebuggerModeForRcmgr",
        "sceKernelGetSystemSwBeta",
        "sceKernelGetSystemSwVersion",
        "sceKernelGetThreadName",
        "sceKernelGettimeofday",
        "sceKernelGettimezone",
        "sceKernelGetTraceMemoryStats",
        "sceKernelGetTscFrequency",
        "sceKernelGetUtokenDataExecutionForRcmgr",
        "sceKernelGetUtokenExpirationTimeNotafterForRcmgr",
        "sceKernelGetUtokenExpirationTimeNotbeforeForRcmgr",
        "sceKernelGetUtokenFakeSharefactoryForRcmgr",
        "sceKernelGetUtokenFlagedUpdaterForRcmgr",
        "sceKernelGetUtokenNpEnvSwitchingForRcmgr",
        "sceKernelGetUtokenSaveDataRepairForRcmgr",
        "sceKernelGetUtokenStoreModeForRcmgr",
        "sceKernelGetUtokenUseSoftwagnerForAcmgr",
        "sceKernelGetUtokenUseSoftwagnerForRcmgr",
        "sceKernelGetUtokenWeakenedPortRestrictionForRcmgr",
        "sceKernelGetVrCaptureSize",
        "sceKernelHasNeoMode",
        "sceKernelHwHasOpticalOut",
        "sceKernelHwHasWlanBt",
        "sceKernelIccControlBDPowerState",
        "sceKernelIccControlUSBPowerState",
        "sceKernelIccGetBDPowerState",
        "sceKernelIccGetCountTime",
        "sceKernelIccGetCPMode",
        "sceKernelIccGetCpuInfoBit",
        "sceKernelIccGetErrLog",
        "sceKernelIccGetHwInfo",
        "sceKernelIccGetPowerNumberOfBootShutdown",
        "sceKernelIccGetPowerOperatingTime",
        "sceKernelIccGetPowerUpCause",
        "sceKernelIccGetSysEventLog",
        "sceKernelIccGetThermalAlert",
        "sceKernelIccGetUSBPowerState",
        "sceKernelIccIndicatorBootDone",
        "sceKernelIccIndicatorShutdown",
        "sceKernelIccIndicatorStandby",
        "sceKernelIccIndicatorStandbyBoot",
        "sceKernelIccIndicatorStandbyShutdown",
        "sceKernelIccNotifyBootStatus",
        "sceKernelIccNvsFlush",
        "sceKernelIccReadPowerBootMessage",
        "sceKernelIccSetBuzzer",
        "sceKernelIccSetCPMode",
        "sceKernelIccSetCpuInfoBit",
        "sceKernelIccSetDownloadMode",
        "sceKernelInstallExceptionHandler",
        "sceKernelInternalGetKmemStatistics",
        "sceKernelInternalGetMapStatistics",
        "sceKernelInternalHeapPrintBacktraceWithModuleInfo",
        "sceKernelInternalMapDirectMemory",
        "sceKernelInternalMapNamedDirectMemory",
        "sceKernelInternalMemoryGetAvailableSize",
        "sceKernelInternalMemoryGetModuleSegmentInfo",
        "sceKernelInternalResumeDirectMemoryRelease",
        "sceKernelInternalSuspendDirectMemoryRelease",
        "sceKernelIsAddressSanitizerEnabled",
        "sceKernelIsAllowedToSelectDvdRegion",
        "sceKernelIsAuthenticNeo",
        "sceKernelIsCEX",
        "sceKernelIsDebuggerAttached",
        "sceKernelIsDevKit",
        "sceKernelIsExperimentalBeta",
        "sceKernelIsGenuineCEX",
        "sceKernelIsGenuineDevKit",
        "sceKernelIsGenuineKratosCex",
        "sceKernelIsGenuineN",
        "sceKernelIsGenuineTestKit",
        "sceKernelIsInSandbox",
        "sceKernelIsKratos",
        "sceKernelIsMainOnStanbyMode",
        "sceKernelIsMainOnStandbyMode",
        "sceKernelIsNeoMode",
        "sceKernelIsStack",
        "sceKernelIsTestKit",
        "sceKernelJitCreateAliasOfSharedMemory",
        "sceKernelJitCreateSharedMemory",
        "sceKernelJitGetSharedMemoryInfo",
        "sceKernelJitMapSharedMemory",
        "sceKernelKernelHeapUsage",
        "sceKernelLoadStartModule",
        "sceKernelLoadStartModuleForSysmodule",
        "sceKernelLseek",
        "sceKernelLwfsAllocateBlock",
        "sceKernelLwfsLseek",
        "sceKernelLwfsSetAttribute",
        "sceKernelLwfsTrimBlock",
        "sceKernelLwfsWrite",
        "sceKernelMapDirectMemory",
        "sceKernelMapDirectMemory2",
        "sceKernelMapFlexibleMemory",
        "sceKernelMapNamedDirectMemory",
        "sceKernelMapNamedFlexibleMemory",
        "sceKernelMapNamedSystemFlexibleMemory",
        "sceKernelMapSanitizerShadowMemory",
        "sceKernelMapTraceMemory",
        "sceKernelMemoryPoolBatch",
        "sceKernelMemoryPoolCommit",
        "sceKernelMemoryPoolDecommit",
        "sceKernelMemoryPoolExpand",
        "sceKernelMemoryPoolGetBlockStats",
        "sceKernelMemoryPoolMove",
        "sceKernelMemoryPoolReserve",
        "sceKernelMkdir",
        "sceKernelMlock",
        "sceKernelMlockall",
        "sceKernelMmap",
        "sceKernelMprotect",
        "sceKernelMsync",
        "sceKernelMtypeprotect",
        "sceKernelMunlock",
        "sceKernelMunlockall",
        "sceKernelMunmap",
        "sceKernelNanosleep",
        "sceKernelNormalizePath",
        "sceKernelNotifyAppStateChanged",
        "sceKernelNotifySystemSuspendResumeProgress",
        "sceKernelNotifySystemSuspendStart",
        "sceKernelOpen",
        "sceKernelOpenEport",
        "sceKernelOpenEventFlag",
        "sceKernelOpenSema",
        "sceKernelPollEventFlag",
        "sceKernelPollSema",
        "sceKernelPread",
        "sceKernelPreadv",
        "sceKernelPrintBacktraceWithModuleInfo",
        "sceKernelProtectDirectMemory",
        "sceKernelProtectDirectMemoryForPID",
        "sceKernelPwrite",
        "sceKernelPwritev",
        "sceKernelQueryMemoryProtection",
        "sceKernelQueryTraceMemory",
        "sceKernelRaiseException",
        "sceKernelRandomizedPath",
        "sceKernelRdup",
        "sceKernelRead",
        "sceKernelReadTsc",
        "sceKernelReadv",
        "sceKernelReboot",
        "sceKernelReleaseDirectMemory",
        "sceKernelReleaseFlexibleMemory",
        "sceKernelReleaseTraceDirectMemory",
        "sceKernelRemoveExceptionHandler",
        "sceKernelRename",
        "sceKernelReportUnpatchedFunctionCall",
        "sceKernelReserve2mbPage",
        "sceKernelReserveSystemDirectMemory",
        "sceKernelReserveVirtualRange",
        "sceKernelResumeDirectMemoryRelease",
        "sceKernelRmdir",
        "sceKernelRtldControl",
        "sceKernelSandboxPath",
        "sceKernelSendNotificationRequest",
        "sceKernelSetAppInfo",
        "sceKernelSetBackupRestoreMode",
        "sceKernelSetBaseModeClock",
        "sceKernelSetBesteffort",
        "sceKernelSetBootReqNotify",
        "sceKernelSetCallRecord",
        "sceKernelSetCompressionAttribute",
        "sceKernelSetCpumodeGame",
        "sceKernelSetDataTransferMode",
        "sceKernelSetEventFlag",
        "sceKernelSetFsstParam",
        "sceKernelSetGameDirectMemoryLimit",
        "sceKernelSetGPI",
        "sceKernelSetGPO",
        "sceKernelSetGpuCu",
        "sceKernelSetMemoryPstate",
        "sceKernelSetNeoModeClock",
        "sceKernelSetPhysFmemLimit",
        "sceKernelSetProcessName",
        "sceKernelSetProcessProperty",
        "sceKernelSetProcessPropertyString",
        "sceKernelSetPrtAperture",
        "sceKernelSetSafemode",
        "sceKernelSettimeofday",
        "sceKernelSetTimezoneInfo",
        "sceKernelSetVirtualRangeName",
        "sceKernelSetVmContainer",
        "sceKernelSignalSema",
        "sceKernelSleep",
        "sceKernelSlvNotifyError",
        "sceKernelStat",
        "sceKernelStopUnloadModule",
        "sceKernelSuspendDirectMemoryRelease",
        "sceKernelSwitchToBaseMode",
        "sceKernelSwitchToNeoMode",
        "sceKernelSync",
        "sceKernelTerminateSysCore",
        "sceKernelTitleWorkaroundIsEnabled",
        "sceKernelTitleWorkdaroundIsEnabled",
        "sceKernelTraceMemoryTypeProtect",
        "sceKernelTriggerEport",
        "sceKernelTriggerUserEvent",
        "sceKernelTruncate",
        "sceKernelUnlink",
        "sceKernelUsleep",
        "sceKernelUtimes",
        "sceKernelUuidCreate",
        "sceKernelVirtualQuery",
        "sceKernelVirtualQueryAll",
        "sceKernelWaitEqueue",
        "sceKernelWaitEventFlag",
        "sceKernelWaitSema",
        "sceKernelWrite",
        "sceKernelWriteSdkEventLog",
        "sceKernelWritev",
        "sceKernelYieldCpumode",
    ];

    public static readonly IReadOnlyList<string> libkernelNids = libkernelSymbols.Select(x => Ps4ModuleLoader.Utils.CalculateNidForSymbol(x)).ToList(); 
}
